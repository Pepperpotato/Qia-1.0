{% extends 'admin/index.html' %}
{% load static %}

{% block content %}
    <section class="rt_wrap content mCustomScrollbar">
        <div class="rt_content">
            <div class="page_title">
                <h3>添加新的商品大类别 <span class="label label-default">New</span>
            </div>
            <form action="{% url 'admin:addbigcategory' %}" method="post" enctype="multipart/form-data" id="form">
                {% csrf_token %}
                <ul class="ulColumn2">

                    <li>
                        <span class="item_name" style="width:190px;">请输入新的商品大类别：</span>
                        <input name="newbigcategory" class="textbox textbox_225"/>
                    </li>
                    <li>
                        <span class="item_name" style="width:120px;">上传图片：</span>
                        <label class="uploadImg">
                            <input name="newpicture" type="file"/>
                        </label>
                    </li>
                    <li>
                        <span class="item_name" style="width:45px;"></span>
                        <input type="button" value="提交" onclick="big()">
                    </li>
                </ul>
            </form>

        </div>
    </section>
    <script>

        function big() {
            $.ajax({

                cache: false,
                contentType: false,

                type: "POST",

                dataType: "json",//返回的数据类型为Json对象

                url: "{% url 'admin:addbigcategory' %}", //发送请求到后台的地址

                data: new FormData(document.getElementById("form")), //发送的数据是id="for"的表单中的数据,其中document.getElementById()函数的功能是根据对象的名称获取对象
                processData: false,//不希望自动转换

                async: false,//请求设为异步

                error: function (request) {//发送请求失败执行的函数

                    alert("发送请求失败！");

                },

                success: function (data) {//发送请求成功执行的函数

                    if (data['code'] == 1) {
                        alert('新大类别已添加')
                    }
                    else
                    {
                        alert('大类别已存在，请重新输入')
                    }
                }

            });
        }

    </script>
{% endblock content %}

{% block foot %}
{% endblock foot %}

